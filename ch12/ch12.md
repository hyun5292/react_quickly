# React 아키텍처

# 12장 Webpack 빌드 도구

> 빌드 도구(번들러)<br/>
> : 작성한 코드를 애플리케이션을 실행할 수 있는 최소 단위의 파일로 묶고, 편리하게 배포하도록 준비해주는 도구

```
#	12-1 Webpack의 역할
	> 핵심은 작성한 자바스크립트 파일을 최적화하여 적은 수의 파일로 사용자 요청을 처리하는 것
	> 세 가지 자바스크립트 모듈인 CommonJS, AMD, ES6 모듈을 모두 지원
	> 프로젝트 내 모든 자바스크립트의 의존성을 분석한 후 다음 작업들을 수행
		- 모든 의존 모듈을 올바른 순서로 불러오도록 함
		- 모든 의존 모듈을 한 번씩만 불러오도록 함
		- 자바스크립트 파일이 가능한 한 적은 파일로 묶여지도록 함(정적 자원)
	> 코드 분리와 정적 자원에 대한 해시 적용 기능도 지원하므로 특정 상황에서만 필요한 코드 블록을 정의 가능
	> 로더를 이용하면 다른 정적 자원에 대한 전처리도 가능
		- JSX, Jade, CoffeScript 파일을 자바스크립트 파일로 변환
		- ES6 미지원 브라우저를 대응하기 위해 ES6+ 코드를 ES5 코드로 변환
		- Sass나 Compass로 작성된 스타일 파일을 CSS로 변환
		- 스프라이트 이미지를 하나의 PNG 파일이나 JPG 파일 또는 인라인 데이터 URI 이미지로 최적화
	> 이 책에서 작업에 사용할 Webpack
		- npm 의존 모듈을 관리하고 번들링하여 일일이 인터넷에서 내려받거나 HTML의 <script> 태그에 추가하지 않아도 사용할 수 있도록 함
		- JSX를 일반적인 자바스크립트로 변환하고 디버깅 편의를 위해 소스맵을 제공
		- 스타일 관리
		- 핫 모듈 대체 적용
		- 개발용 웹 서버를 실행
	> webpack.config.js 파일을 이용하면 Webpack의 로드, 전처리, 번들링 과정 설정 가능
```

```
# 12-2 프로젝트에 Webpack 적용하기
	> 단계
		1. Webpack 설치하기
		2. 의존 모듈을 설치하고, package.json에 저장
		3. webpack.config.js를 통해 Webpack 설정하기
		4. 개발 서버(webpack-dev-server)와 핫 모듈 대체 설정하기

	# 12-2-1 Webpack과 의존 모듈 설치
		> package.json의 scripts 항목에 있는 명령은 선택사항이지만 매우 권장하는 방식
		> React와 Node.js를 사용할 때 npm 스크립트로 실행과 빌드 명령을 처리라는 것이 모범 사례

	# 12-2-2 Webpack 설정
		> Webpack이 번들링을 하기 위해서는 처리할 대상(소스 코드)와 로더를 이용한 처리 방법을 전달 받아야 함, 이런 역할을 하는 것이 프로젝트 최상위에 있는 webpack.config.js
			- JSX 파일을 자바스크립트 파일로 변환
				: babel-loader, babel-core, babel-preset-react
			- css-loader를 이용해서 require로 CSS를 불러오고, url과 imports를 처리
			- style-loader를 이용해서 CSS를 <style> 태그로 삽입
			- 모든 자바스크립트 파일을 bundle.js 파일이라는 하나의 파일로 묶음
			- 소스맵을 통해 개발자 도구에서 적절하게 소스 코드의 행을 확인 가능
```

```
# 12-3 코드 모듈화
```

```
# 12-4 Webpack의 실행과 빌드 테스트
	> ESLint
		: 미리 설정한 규칙 또는 규칙 집합을 통해 자바스크립트나 JSX 코드가 동일한 표준을 따르도록 하는 도구
		>> eslint-plugin-react도 설치해야 함
		>> React 규칙을 .eslintrc.json 파일에 추가해야 함
	> Flow
		: 스크립트에 특별한 주석과 타입을 추가할 수 있는 정적 타입 검사 도구
		>> 성가신 버그를 방지할 수 있는 좋은 도구
```

```
# 12-5 핫 모듈 대체
	> 코드를 작성하여 브라우저에 변경 사항을 반영하는 과정에서 앱의 상태를 유지한 상태로 변경을 적용하므로 좀 더 빠르게 변경 사항 확인 가능
	> HMR을 사용하면 새로고침을 하지 않고도 페이지에 변경 사항이 반영됨
	> Webpack HMR과 개발 서버는 웹소켑을 사용하여 서버로부터 갱신에 대한 알림이 오는지 감시함. 변경이 발생하면 프론트엔드에서 변경 사항에 해당하는 자바스크립트 코드 뭉치와 갱신 목록을 담은 JSON 형식의 매니페스트를 전달 받음

	# 12-5-1 HMR 설정 방법
		> 특정 모듈에만 HMR을 적용하고 싶다면, react-hot-loader를 사용하는 대신 module.hot.accept() 문을 JSX 또는 자바스크립트 모듈에 선택적으로 추가하여 HMR을 원하는 곳에만 적용 가능

	# 12-5-2 HMR 실행
```
